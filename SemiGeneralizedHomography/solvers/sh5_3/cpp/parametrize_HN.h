#pragma once

#include <Eigen/Eigen>


namespace sh5_3
{
    inline Eigen::Matrix<double, 8, 10> parameterize_HN(const Eigen::Matrix<double, 3, 5>& q, const Eigen::Matrix<double, 3, 5>& p, const Eigen::Matrix<double, 3, 5>& c)
    {
        Eigen::Matrix<double, 8, 10> M;
        M << 0, -p(2, 1) * q(0, 1), 0, -p(2, 1) * q(1, 1), p(1, 1)* q(1, 1), p(1, 1)* q(2, 1), c(0, 1)* q(0, 1), c(0, 1)* q(1, 1), c(0, 1) * q(2, 1), p(1, 1) * q(0, 1),
            p(2, 1)* q(0, 1), 0, p(2, 1)* q(1, 1), 0, -p(0, 1) * q(1, 1), -p(0, 1) * q(2, 1), c(1, 1)* q(0, 1), c(1, 1)* q(1, 1), c(1, 1) * q(2, 1), -p(0, 1)* q(0, 1),
            0, -p(2, 2) * q(0, 2), 0, -p(2, 2) * q(1, 2), p(1, 2)* q(1, 2), p(1, 2)* q(2, 2), c(0, 2)* q(0, 2), c(0, 2)* q(1, 2), c(0, 2) * q(2, 2), p(1, 2) * q(0, 2),
            p(2, 2)* q(0, 2), 0, p(2, 2)* q(1, 2), 0, -p(0, 2) * q(1, 2), -p(0, 2) * q(2, 2), c(1, 2)* q(0, 2), c(1, 2)* q(1, 2), c(1, 2) * q(2, 2), -p(0, 2)* q(0, 2),
            0, -p(2, 3) * q(0, 3), 0, -p(2, 3) * q(1, 3), p(1, 3)* q(1, 3), p(1, 3)* q(2, 3), c(0, 3)* q(0, 3), c(0, 3)* q(1, 3), c(0, 3) * q(2, 3), p(1, 3) * q(0, 3),
            p(2, 3)* q(0, 3), 0, p(2, 3)* q(1, 3), 0, -p(0, 3) * q(1, 3), -p(0, 3) * q(2, 3), c(1, 3)* q(0, 3), c(1, 3)* q(1, 3), c(1, 3) * q(2, 3), -p(0, 3)* q(0, 3),
            0, -p(2, 4) * q(0, 4), 0, -p(2, 4) * q(1, 4), p(1, 4)* q(1, 4), p(1, 4)* q(2, 4), c(0, 4)* q(0, 4), c(0, 4)* q(1, 4), c(0, 4) * q(2, 4), p(1, 4) * q(0, 4),
            p(2, 4)* q(0, 4), 0, p(2, 4)* q(1, 4), 0, -p(0, 4) * q(1, 4), -p(0, 4) * q(2, 4), c(1, 4)* q(0, 4), c(1, 4)* q(1, 4), c(1, 4) * q(2, 4), -p(0, 4)* q(0, 4);
            
         return M;
    }
}